<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Cliente - YourWeek</title>
    <link rel="stylesheet" href="clientePage.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="cookie-banner.css">
</head>

<body>
    <div class="back-to-login">
        <a href="loginPage.html">
            <i class="fas fa-arrow-left"></i>
            Torna al Login
        </a>
    </div>

    <header class="dashboard-header">
        <div class="logo">
            <h1>YourWeek</h1>
        </div>
        <div class="user-info">
            <div class="user-avatar">
                <i class="fas fa-user"></i>
            </div>
            <div>
                <h3 id="userName">Benvenuto Cliente!</h3>
                <p>Accesso effettuato con successo</p>
            </div>
        </div>
    </header>

    <main class="dashboard-content">
        <div class="welcome-section">
            <h2>La Tua Dashboard Personale</h2>
            <p>Gestisci il tuo piano alimentare e monitora i tuoi progressi</p>
        </div>

        <div class="stats-section">
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-weight"></i></div>
                <div class="stat-value">-3.5</div>
                <div class="stat-label">Kg Persi</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                <div class="stat-value">24</div>
                <div class="stat-label">Piani Seguiti</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-flame"></i></div>
                <div class="stat-value">2,150</div>
                <div class="stat-label">Cal. Medie</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-target"></i></div>
                <div class="stat-value">87%</div>
                <div class="stat-label">Obiettivo Mese</div>
            </div>
        </div>

        <div class="features-grid">
            <div class="feature-card" onclick="location.href='pianoAlimentare.html'">
                <i class="fas fa-utensils"></i>
                <h3>Piano Alimentare</h3>
                <p>Visualizza il tuo piano alimentare personalizzato creato dal nutrizionista</p>
                <button class="btn-small">Vai al Piano</button>
            </div>

            <div class="feature-card">
                <i class="fas fa-chart-line"></i>
                <h3>Progressi</h3>
                <p>Monitora i tuoi progressi e raggiungi i tuoi obiettivi di benessere</p>
                <button class="btn-small">Visualizza</button>
            </div>

            <div class="feature-card">
                <i class="fas fa-calendar-alt"></i>
                <h3>Appuntamenti</h3>
                <p>Prenota e gestisci i tuoi appuntamenti con il nutrizionista</p>
                <button class="btn-small">Prenota Ora</button>
            </div>

            <div class="feature-card">
                <i class="fas fa-comments"></i>
                <h3>Messaggi</h3>
                <p>Comunica direttamente con il tuo nutrizionista per consigli personalizzati</p>
                <button class="btn-small">Apri Chat</button>
            </div>

            <div class="feature-card" onclick="location.href='trovaNutrizionista.html'">
                <i class="fas fa-user-md"></i>
                <h3>Trova nutrizionista</h3>
                <p>Cerca nutrizionisti nella tua provincia e trova il professionista più adatto a te</p>
                <button class="btn-small">Trova nella tua zona</button>
            </div>
        </div>

        <div class="activity-section">
            <h3><i class="fas fa-history"></i> Attività Recente</h3>
            <ul class="activity-list">
                <li class="activity-item">
                    <div class="activity-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="activity-content">
                        <div class="activity-title">Piano settimanale completato</div>
                        <div class="activity-date">Completato 2 giorni fa</div>
                    </div>
                </li>
                <li class="activity-item">
                    <div class="activity-icon"><i class="fas fa-pencil-alt"></i></div>
                    <div class="activity-content">
                        <div class="activity-title">Piano alimentare aggiornato</div>
                        <div class="activity-date">Aggiornato 5 giorni fa</div>
                    </div>
                </li>
                <li class="activity-item">
                    <div class="activity-icon"><i class="fas fa-dumbbell"></i></div>
                    <div class="activity-content">
                        <div class="activity-title">Nuovo appuntamento prenotato</div>
                        <div class="activity-date">Prenotato 1 settimana fa</div>
                    </div>
                </li>
                <li class="activity-item">
                    <div class="activity-icon"><i class="fas fa-chart-bar"></i></div>
                    <div class="activity-content">
                        <div class="activity-title">Obiettivo mensile raggiunto al 87%</div>
                        <div class="activity-date">Aggiornato oggi</div>
                    </div>
                </li>
            </ul>
        </div>
    </main>

    <script>
        // Verifica autenticazione e carica dati utente
        async function checkAuthAndLoadUser() {
            try {
                const response = await fetch('../api/auth.php?action=check', {
                    method: 'GET',
                    credentials: 'include'
                });

                const result = await response.json();

                if (result.success && result.authenticated) {
                    // Aggiorna il nome utente nell'header
                    const userName = result.user.name || 'Cliente';
                    document.getElementById('userName').textContent = `Benvenuto ${userName}!`;
                } else {
                    // Se non autenticato, reindirizza al login
                    alert('Sessione scaduta. Effettua nuovamente il login.');
                    window.location.href = 'loginPage.html';
                }
            } catch (error) {
                console.error('Errore verifica autenticazione:', error);
            }
        }

        // Carica i dati utente al caricamento della pagina
        document.addEventListener('DOMContentLoaded', checkAuthAndLoadUser);
    </script>
    <script src="cookie-banner.js"></script>
</body>

</html>